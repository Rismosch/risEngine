# ris_engine

Barebones game engine. Home made passion project. 

üèóÔ∏è **VERY WIP** üë∑

![thumbnail](assets/__raw/images/ris_engine_small.png "Generated by DALL¬∑E - Prompt: \"an expressive oil painting of an engine, burning is colourful pigments\"")

---

## Features:

- [x] Startup, shutdown, mainloop and error handling
- [x] Logging, to console and file
- [x] Threadpool based concurrency
- [x] Remappable controls
  - [x] Mouse
  - [x] Keyboard
  - [x] Gamepad
- [x] 3d math
  - [x] Vectors and Matrices
  - [x] Quaternions
  - [x] Color
    - [x] RGB
    - [x] OkLab
- [x] Basic 3d renderer via Vulkan
- [x] Debug GUI via Dear ImGui
- [ ] Debug gizmos
  - [ ] Point
  - [ ] Line/ray
  - [ ] Sphere
  - [ ] Bounding box
  - [ ] Text
- [x] Asset System
  - [x] Importing (convert raw assets to usable form)
  - [x] Loading (use in engine)
  - [x] (De)compiling
- [x] Codecs
  - [x] GLSL to SpirV, with custom pre processor
  - [x] QOI
- [x] Safe global accessible mutable state
  - [x] Settings/Configuration
  - [ ] Gameobjects

---

## Requirements

|          |                          | Notes                                                    |
|----------|--------------------------|----------------------------------------------------------|
| Compiler | rustc 1.77.2             | [Download Link](https://www.rust-lang.org/tools/install) | 
| Platform | x86_64 Windows and Linux | may or may not compile on other platforms                |
| Graphics | Vulkan capable Hardware  |                                                          |

You also require an internet connection, to download dependencies from [crates.io](https://crates.io/). You can [vendor](https://doc.rust-lang.org/cargo/commands/cargo-vendor.html) crates for offline use or download an archived repo from [my website](https://www.rismosch.com/archive).  Note that I make these archives sporadically, meaning they may not be up to date.

---

## Installation

This engine is using various 3rd party libraries. Trying to build without these will most definitely result in diverse compile, linker and runtime errors. Depending on your platform, follow the instructions below.


### Linux

Examples use the `pacman` package manager from Arch.

#### 1. Install [SDL2](https://archlinux.org/packages/extra/x86_64/sdl2/)

    sudo pacman -S sdl2

#### 2. Install [shaderc](https://archlinux.org/packages/extra/x86_64/shaderc/)

    sudo pacman -S shaderc

#### 3. Install [Vulkan](https://wiki.archlinux.org/title/Vulkan)

Depending on your graphics card, you need to install a different package. Follow the instructions in the link below:

https://wiki.archlinux.org/title/Vulkan#Installation

---

### Windows

In this repo you will find the   `./3rd_party/` directory. It contains all required libraries for Windows.

For information where I got these from, read [./3rd_party/README.md](3rd_party/README.md). 

#### 1. Copy _EVERY_ `*.dll` in `./3rd_party/bin/` to the root of this repository.

`cargo run` expects all necessary DLLs to be in the root directory. Also, the `./ci/build.ps1` script expects these to be in the root directory as well.

#### 2. Set the environment variable `SHADERC_LIB_DIR` to `./3rd_party/bin/`

[shaderc](https://crates.io/crates/shaderc) requires the DLL `shaderc_shared.dll` during build time. It has a feature, which stores and compiles shader code inside Rust source files. `ris_engine` does not use this feature, but nevertheless, `shaderc` does try to search the DLL while building. The environment variable `SHADERC_LIB_DIR` is the directory where `shaderc` searches for the DLL.

#### 3. Copy _EVERY_ `*.lib` in `./3rd_party/lib/` to the directory, which the linker searches for static libraries.

If you are using `rustup`, this directory probably is:

    C:\Users\<your username>\.rustup\toolchains\<current toolchain>\lib\rustlib\<current toolchain>\lib

Rust still needs to link. And this directory is the one that `cargo` searches for libraries.

---

## Building

Assuming everything is installed correctly, you can now compile and run the engine with:

    cargo run

Alternatively, you can build a release-ready package, by running a build script found under `./ci/`.

Windows:

    ./ci/build.ps1

Linux:

    bash ./ci/build.sh

These build scripts will generate building information, compile the entire workspace and move all required files into a single folder. Note that these script build with all optimizations enabled, which significantly increases the build time. Once a script is finished, you will find the following files in `./ci_out/build/`:

1. **ris_engine.exe**  
   This is the compiled engine. It contains all logic to run the game.

2. **ris_assets**  
   This file contains all assets used by the engine. Without assets, the game cannot be run.

3. **SDL2.dll** (only on windows)  
   This is a multi media library, which provides low level access to audio, keyboard, mouse, joystick and windowing.

For more info on the scripts, check out [./ci/README.md](ci/README.md).

## Testing

All tests are found under `./tests/suite/` and can be run with:

    cargo test

If you have [miri](https://github.com/rust-lang/miri) installed, tests can be run with:

    cargo miri test

